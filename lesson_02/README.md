# Урок 2. Дискретные распределения вероятностей

## Теория
**Случайная величина** - это величина, которая в результате испытания принимает только одно возможное значение.

Случайную величину принято обозначать X (X-большое), а ее значения $x_1, x_2, \dots , x_n$

Случайные величины принято делить на две большие категории: **дискретные** и **непрерывные**. Дискретные принимают счетные, отдельные друг от друга значения. А непрерывные лежат в некотором интервале, который можем измерить с той точностью, что позволяет прибор или с той точностью, которая необходима.

**Закон распределения вероятностей случайной величины** - это соответствие между возможными значениями этой величины и вероятностями, которые этим значениям соответствуют.

Иными словами закон распределения вероятностей случайной величины - это модель, которая описывает  поведение этой случайной величины.

### Формула Бернулли (биномиальное распределение)

Случайная дискретная величина **X** имеет биномиальное распределение с переменными **k**, **n** и **p**, если вероятность ее распределения задается следующим уравнением:

$P_n (X=k) = C_n^k \cdot p^k \cdot q^{n-k}$

где 
- k - число наступления события (дискретная величина из отрезка [0, n])
- n - число испытаний 
- p - вероятность наступления события A в независимых испытаниях
- q￼- противоположная вероятность (1-p)

Формулой Бернулли удобно пользоваться, когда нам нужно найти вероятность, что событие наступит сколько-то раз из скольки-то (k раз из n), при этом вероятность наступления события достаточно велика (>0.1) и число испытаний не очень большое (< 10 - 15).

---
**Задача 01.** 3 раза подбрасываем монетку (n=3). Какая вероятность, что орел выпадет 0 раз, 1 раз, 2 раза и 3 раза.

$\displaystyle 
P_n (X=0) = C_n^k \cdot p^k \cdot q^{n-k} = C_3^0 \cdot p^0 \cdot q^3 = 
\frac{3!}{0!(3-0)!} \cdot 1 \cdot 0.125 = 1 \cdot 1 \cdot 0.125 = 0.125$

$\displaystyle 
P_n (X=1) = C_n^k \cdot p^k \cdot q^{n-k} = C_3^1 \cdot p^1 \cdot q^2 = 
\frac{3!}{1!(3-1)!} \cdot 0.5 \cdot 0.25 = 3 \cdot 0.5 \cdot 0.25 = 0.375$

$\displaystyle 
P_n (X=2) = C_n^k \cdot p^k \cdot q^{n-k} = C_3^2 \cdot p^2 \cdot q^1 = 
\frac{3!}{2!(3-2)!} \cdot 0.25 \cdot 0.5 = 3 \cdot 0.25 \cdot 0.5 = 0.375$

$\displaystyle 
P_n (X=3) = C_n^k \cdot p^k \cdot q^{n-k} = C_3^3 \cdot p^3 \cdot q^0 = 
\frac{3!}{3!(3-3)!} \cdot 0.125 \cdot 1 = 1 \cdot 0.125 \cdot 1 = 0.125$

---
**Задача 02.** 3 раза подбрасываем монетку (n=3). Какая вероятность, что орел выпадет 0 раз, 1 раз, 2 раза и 3 раза (теперь - без формулы Бернулли)

$\displaystyle 
P_n (X=0) C_n^k \cdot p^k \cdot q^{n-k} = C_3^0 \cdot p^0 \cdot q^3 = 
\frac{3!}{0!(3-0)!} \cdot 1 \cdot 0.125 = 1 $

$\displaystyle 
P_n (X=1) C_n^k \cdot p^k \cdot q^{n-k} = C_3^1 \cdot p^1 \cdot q^2 = 
\frac{3!}{1!(3-1)!} \cdot 0.5 \cdot 0.25 = 3$

$\displaystyle 
P_n (X=2) C_n^k \cdot p^k \cdot q^{n-k} = C_3^2 \cdot p^2 \cdot q^1 = 
\frac{3!}{2!(3-2)!} \cdot 0.25 \cdot 0.5 = 3$

$\displaystyle 
P_n (X=3) C_n^k \cdot p^k \cdot q^{n-k} = C_3^3 \cdot p^3 \cdot q^0 = 
\frac{3!}{3!(3-3)!} = 1$

Считаем общее количество исходов = 1 + 3 + 3 + 1 = 8.<br>

И теперь:

$\displaystyle P_n (X=0) = \frac{1}{8} = 0.125$

$\displaystyle P_n (X=1) = \frac{3}{8} = 0.375$

$\displaystyle P_n (X=2) = \frac{3}{8} = 0.375$

$\displaystyle P_n (X=3) = \frac{1}{8} = 0.125$

---

### Распределение Пуассона (частный случай биномиального распределения)

В том случае, если проводится большое количество испытаний n и при этом вероятность p появления события A в отдельном испытании мала (<0,1), применяют формулу Пуассона для вычисления вероятности того, что событие произойдет m раз за n испытаний:

$\displaystyle P_m = \frac{\lambda^m}{m!}\cdot e^{-\lambda}$

- $\lambda$ - среднее количество наступления события за определенную единицу измерений (средняя интенсивность), например: потребителей/час, вкраплений/кв.метр￼
- e - число Эллера (~ 2.72)

---
**Задача 03.** Вероятность того, что среди писем, поступающих на определенный почтовый ящик, встретится письмо со спамом, составляет 0.01. Найдите вероятность того, что среди 1000 писем, поступивших на него за месяц, будет 11 со спамом.

- m = 11
- $\lambda$ = p * n = 0.01 * 1000 = 10
- e = 2.72

$\displaystyle P_{11} = \frac{10^{11}}{11!} \cdot e^{-10} = 0.113$

---
**Задача 04.** В среднем при изготовлении напольного покрытия на 1 кв.м встречается 2 вкрапления. Какова вероятность, что на 1 кв.м будет не более 1 вкрапления?

- m = 1
- $\lambda$ = 2 * 1 = 2
- e = 2.72

$\displaystyle P_0 + P_1 = \frac{2^{0}}{0!} \cdot e^{-2} + \frac{2^{1}}{1!} \cdot e^{-2} = 0.405$

---

### Описательные статистики биномиального распределения

- **Математическое ожидание** – это среднее значение случайной величины, при числе испытаний стремящихся к бесконечности

$M(X) = n \cdot p$

- **Дисперсия** - характеризует степень рассеянности значений случайной величины относительно ее математического ожидания

$D = n \cdot p \cdot q$<br>
$q = 1 - p$

- **Среднее квадратичное (стандартное) отклонение** показывает, насколько далеко наблюдения могут быть "разбросаны" относительно их среднего значения ￼

$\sigma = \sqrt{D}$

### Описательная статистика для распределения Пуассона

- **Математическое ожидание**

$M(X) = n \cdot p = \lambda$

- **Дисперсия** 

$D = \lambda$

## Задачи со звездочкой

Число $k_0$, которому, которому при заданном n соответствует максимальная биномиальная вероятность $P_n(k_0)$, называется наивероятнейшим числом появления события А. При заданных n и p это число определяется неравенствами

$np - q <= k_0 <= np + p$

Если число $np + p$ не является целым числом, то $k_0$ равно целой части этого значения (всегда сначала считаем это)

либо - уточняем:

Если $np + p$ - целое число, то наивероятнейшее число исходов $k_0$ принимает два значения $np + q$ и $np + p$

---
**Задача 05.** Сколько раз нужно подбросить кубик, чтобы наивероятнейшее число было 30

Исходя из условий задачи нам известно:
- $k_0$ = 30
- $\displaystyle p = \frac{1}{6}$
- $\displaystyle q = \frac{5}{6}$

$\displaystyle np - q <= k_0 <= np + p$<br><br>
$\displaystyle n \frac{1}{6} - \frac{5}{6} <= 30 <= n \frac{1}{6} + \frac{1}{6}$<br>

Домножим все на 6:

$\displaystyle n - 5 <= 180 <= n + 1$<br>

$\displaystyle 
\begin{aligned}
 \begin{cases}
   n - 5 - 180 <= 0, 
   \\
   n + 1 - 180 >= 0,
 \end{cases}
\end{aligned}
$

$\displaystyle 
\begin{aligned}
 \begin{cases}
   n - 5 - 180 <= 5 + 180 <= 185, 
   \\
   n + 1 - 180 >= -1 + 180 >= 179,
 \end{cases}
\end{aligned}
$

$n \in [179, 185]$

---
**Задача 06.** Какова вероятность наступления сообытия B в каждом отдельном испытании, если наивероятнейшее число наступления события B в 120 испытаниях равна 32.

- $k_0$ = 32
- n = 120

$\displaystyle 120 \cdot x - (1-x) <= 32 <= 120 \cdot x + x$<br>

$\displaystyle 
\begin{aligned}
 \begin{cases}
   120 \cdot x - (1-x) <= 32, 
   \\
   120 \cdot x + x >= 32,
 \end{cases}
\end{aligned}
$

$\displaystyle 
\begin{aligned}
 \begin{cases}
   x <= \frac{33}{121}, 
   \\
   x >= \frac{32}{121},
 \end{cases}
\end{aligned}
$

$p \in [0.264, 0.273]$

---
**Задача 07.** Определить наиболее вероятное число выпадений орла при 25 подбрасываниях монеты

- n = 25
- p = 1/2

$\displaystyle 25 \cdot \frac{1}{2} - \frac{1}{2} <= x <= 25 \cdot \frac{1}{2} + \frac{1}{2}$<br>

домножим на 2

$\displaystyle 25 - 1 <= 2x <= 25 + 1$<br>


$\displaystyle 
\begin{aligned}
 \begin{cases}
   24 <= 2x, 
   \\
   26 >= 2x,
 \end{cases}
\end{aligned}
$

$\displaystyle 
\begin{aligned}
 \begin{cases}
   x >= \frac{24}{2} >= 12, 
   \\
   x <= \frac{26}{2} <= 13,
 \end{cases}
\end{aligned}
$

$x \in [12, 13]$

---
**Задача 08.** Вероятность рождения мальчиков 0.515. Найти вероятнейшее число девочек из 600 новорожденных.

- n = 600
- q = 0.515
- p = 1 - q = 0.485

$np + p = 600 \cdot 0.485 + 0.485 = 291.485$

результат расчета - не целое число => отбрасываем дробную часть

$np + p = 291$


$\displaystyle 600 \cdot 0.485 - 0.515 <= x <= 600 \cdot 0.485 + 0.485$<br>


$\displaystyle 
\begin{aligned}
 \begin{cases}
   600 \cdot 0.485 - 0.515 <= x, 
   \\
   600 \cdot 0.485 + 0.485 >= x,
 \end{cases}
\end{aligned}
$

$\displaystyle 
\begin{aligned}
 \begin{cases}
   600 \cdot 0.485 - 0.515 <= x, 
   \\
   600 \cdot 0.485 + 0.485 >= x,
 \end{cases}
\end{aligned}
$

## Итог

**Биномиальное распределение:**

- известна точная вероятность
- надо найти вероятность наступления события k раз из n (найти вероятность, что биатлонист попадет 3 раза из 10, зная, что вероятность его попадания 0.7)
- свойственно небольшое число испытаний

**Распределение Пуассона:**

- известна средняя вероятность или средняя интенсивность наступления события, 
- число испытаний стремится к бесконечности, 
- вероятность наступления события очень маленькая (< 0.01)
